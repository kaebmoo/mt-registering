{% extends "admin/admin_base.html" %}
{% import "admin/components/pagination.html" as pagination_macros %}

{% block title %}รายชื่อพนักงาน{% endblock %}

{% block admin_content %}
    <h1 class="ui header">
        <i class="users icon"></i>
        <div class="content">
            รายชื่อพนักงาน
            <div class="sub header">ข้อมูลพนักงานทั้งหมดในระบบ</div>
        </div>
    </h1>

    <div class="ui segment">
        <form class="ui form" method="GET" action="{{ url_for('admin.employees') }}">
            <div class="fields">
                <div class="twelve wide field">
                    <div class="ui icon input">
                        <input type="text" name="search" placeholder="ค้นหารหัส, ชื่อ, ตำแหน่ง, แผนก..." value="{{ search }}">
                        <i class="search icon"></i>
                    </div>
                </div>
                <div class="four wide field">
                    <button class="ui primary button" type="submit">
                        <i class="search icon"></i> ค้นหา
                    </button>
                    {% if search %}
                    <a href="{{ url_for('admin.employees') }}" class="ui button">
                        <i class="times icon"></i> ล้าง
                    </a>
                    {% endif %}
                </div>
            </div>
        </form>
        
        <div class="ui right floated label">
            {% if search %}
                พบ {{ employees.total }} รายการ
            {% else %}
                ทั้งหมด {{ employees.total }} คน
            {% endif %}
        </div>
    </div>

    <table class="ui celled table">
        <thead>
            <tr>
                <th>รหัสพนักงาน</th>
                <th>ชื่อ-นามสกุล</th>
                <th>ตำแหน่ง</th>
                <th>ส่วนงาน</th>
                <th>ศูนย์ต้นทุน</th>
            </tr>
        </thead>
        <tbody>
            {% for emp in employees.items %}
            <tr>
                <td>{{ emp.emp_id }}</td>
                <td>{{ emp.emp_name }}</td>
                <td>{{ emp.position or '-' }}</td>
                <td>{{ emp.sec_short or '-' }}</td>
                <td>{{ emp.cc_name or '-' }}</td>
            </tr>
            {% else %}
            <tr>
                <td colspan="5" class="center aligned">
                    {% if search %}
                        ไม่พบข้อมูลที่ค้นหา
                    {% else %}
                        ไม่มีข้อมูลพนักงาน
                    {% endif %}
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <!-- Pagination -->
   <!-- Pagination - ส่ง search parameter -->
    {% if search %}
        {{ pagination_macros.render_pagination(employees, 'admin.employees', {'search': search}) }}
    {% else %}
        {{ pagination_macros.render_pagination(employees, 'admin.employees') }}
    {% endif %}

{% endblock %}